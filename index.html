<script type="module">
  import { createSession } from "https://esm.sh/@shapediver/viewer@3.7.4";

  console.log("SD TEST: ESM loaded");

  const ticket =
    "2a676cfde702983d5ca9b58fcab4319424a73cbf44e3d568685b9145619028764bbf12509c65a059f3c679b27c0be7292b1fd83bb30608bab6aa9a39615f8988e9efce8986adcb6c82a2a4c780e53a42d88e8a11872bbfc731cad63a4e77fd5cce549fbbe63402-eec7c28946fb0fc6d105ea6afb77dae6";

  window.addEventListener("load", () => {
    console.log("SD TEST: window loaded");

    const container = document.getElementById("viewer");
    console.log("SD TEST: container", container);

    // wait for layout + paint (CRITICAL)
    requestAnimationFrame(() => {
      requestAnimationFrame(async () => {
        try {
          const session = await createSession({
            ticket,
            modelViewUrl: "https://sdeuc1.eu-central-1.shapediver.com",
            container
          });

          console.log("SD TEST: session created", session);
        } catch (err) {
          console.error("SD TEST FAILED", err);
        }
      });
    });
  });
</script>
